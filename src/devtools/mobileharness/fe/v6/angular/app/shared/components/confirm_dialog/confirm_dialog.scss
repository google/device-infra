@use '@angular/material' as mat;
@use '../../styles/common';
@use '../../styles/typography';

::ng-deep body .confirm-dialog-panel {
  @include mat.dialog-overrides((
    container-shape: .5rem,
  ));
}

.confirm-dialog-container {
  padding: 1.5rem;
  min-width: 24rem;
  max-width: min-content;
}

.confirm-dialog-header {
  display: flex;
  align-items: center;
  flex-direction: column;
  gap: 1rem;

  h3 {
    font-weight: 600;
    margin: 0;
    font-size: 1.125rem;
    line-height: 1.75rem;
    margin-bottom: 1rem;
  }
}

.sub-modal-content {
  text-align: center;
  font-family: typography.$labconsole-font;
  letter-spacing: normal;
  padding: 0;
  max-height: 60vh;
  overflow-y: auto;
  @include common.shared-scrollbar-style();

  p {
    font-size: 0.875rem;
    line-height: 1.25rem;
    max-width: 24rem;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 1.5rem;
  }

  .html-content {
    text-align: left;
    margin-bottom: 1.5rem;
    font-size: 0.875rem;
    color: #374151;

    ::ng-deep {
      mat-icon,
      .material-icons {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        font-feature-settings: 'liga';
      }

      // Requirements Box (Blue)
      .requirements-box {
        background-color: rgba(#eff6ff, 0.5); // bg-blue-50/50
        border: 1px solid #dbeafe; // border-blue-100
        border-radius: 0.5rem;
        padding: 1rem;
        margin-bottom: 1.5rem;

        h4 {
          color: #1e3a8a; // text-blue-900
          font-weight: 600;
          font-size: 0.875rem;
          margin: 0 0 0.75rem 0;
          display: flex;
          align-items: center;
          gap: 0.5rem;

          mat-icon,
          .material-icons {
            color: #2563eb; // text-blue-600
            font-size: 1rem;
            height: 1rem;
            width: 1rem;
          }
        }

        ul {
          list-style: none;
          padding: 0;
          margin: 0;
          display: flex;
          flex-direction: column;
          gap: 0.25rem;

          li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #374151; // text-gray-700
            font-size: 0.875rem;

            .dot {
              width: 0.375rem;
              height: 0.375rem;
              border-radius: 9999px;
              background-color: #60a5fa; // bg-blue-400
              flex-shrink: 0;
            }

            code {
              background-color: white;
              border: 1px solid #dbeafe; // border-blue-100
              padding: 0.125rem 0.375rem;
              border-radius: 0.25rem;
              color: #1d4ed8; // text-blue-700
              font-family: 'Roboto Mono', monospace;
              font-size: 0.75rem;
              line-height: 1rem;
            }

            .status-badge {
              color: #15803d; // text-green-700
              background-color: #f0fdf4; // bg-green-50
              border: 1px solid #dcfce7; // border-green-100
              padding: 0.125rem 0.375rem;
              border-radius: 0.25rem;
              font-size: 0.75rem;
              font-weight: 700;
              line-height: 1rem;
            }
          }
        }
      }

      // Incompatible Devices Section
      .incompatible-devices-section {
        h4 {
          color: #111827; // text-gray-900
          font-weight: 600;
          font-size: 0.875rem;
          margin-bottom: 0.75rem;
          display: flex;
          align-items: center;
          gap: 0.5rem;

          mat-icon,
          .material-icons {
            color: #ef4444; // text-red-500
            font-size: 1rem;
            height: 1rem;
            width: 1rem;
          }

          .count {
            color: #9ca3af; // text-gray-400
            font-weight: 400;
          }
        }
      }

      // Generic Device List Box
      .device-list-box {
        border: 1px solid #e5e7eb; // border-gray-200
        border-radius: 0.5rem;
        background-color: white;
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); // shadow-sm
        max-height: 12rem;
        overflow-y: auto;

        @include common.shared-scrollbar-style();

        .device-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.625rem;
          border-bottom: 1px solid #f3f4f6; // border-gray-100
          transition: background-color 0.2s;

          &:last-child {
            border-bottom: 0;
          }
          &:hover {
            background-color: #f9fafb; // hover:bg-gray-50
          }

          .device-id {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151; // text-gray-700
          }

          .reason-badge {
            font-size: 0.75rem;
            font-weight: 500;
            color: #b91c1c; // text-red-700
            background-color: #fef2f2; // bg-red-50
            border: 1px solid #fee2e2; // border-red-100
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            line-height: 1rem;
          }
        }
      }

      // Connection Error (Amber Box)
      .amber-box {
        background-color: rgba(#fffbeb, 0.5); // bg-amber-50/50
        border: 1px solid #fef3c7; // border-amber-100
        border-radius: 0.5rem;
        padding: 1rem;
        margin-bottom: 1.25rem;

        h4 {
          color: #78350f; // text-amber-900
          font-weight: 600;
          font-size: 0.875rem;
          margin: 0 0 0.5rem 0;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          mat-icon {
            color: #d97706; // text-amber-600
            font-size: 1rem;
            height: 1rem;
            width: 1rem;
          }
        }

        p {
          font-size: 0.875rem;
          color: #92400e; // text-amber-800
          line-height: 1.5;
          margin-bottom: 0;
          max-width: none; // Reset max-width for this p
        }
      }

      // Capabilities List (Proxy Error)
      .capabilities-list {
        h4 {
          color: #111827; // text-gray-900
          font-weight: 600;
          font-size: 0.875rem;
          margin-bottom: 0.75rem;
        }

        .device-row-col {
          display: flex;
          flex-direction: column;
          padding: 0.75rem;
          border-bottom: 1px solid #f3f4f6;
          transition: background-color 0.2s;

          &:last-child {
            border-bottom: 0;
          }
          &:hover {
            background-color: #f9fafb;
          }

          .device-id {
            font-family: 'Roboto Mono', monospace;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
          }

          .capabilities {
            font-size: 0.75rem;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 0.25rem;

            mat-icon,
            .material-icons {
              font-size: 0.875rem;
              height: 0.875rem;
              width: 0.875rem;
              color: #9ca3af;
            }
          }
        }
      }

      .decommission-box {
        display: flex;
        flex-direction: column;
        gap: 1rem;

        p {
          text-align: center;
        }

        .items-list-container {
          background-color: #fef2f2; // red-50
          border-radius: 0.5rem;
          border: 1px solid #fee2e2; // red-100
          padding: 0.75rem;
          text-align: left; // match p margin

          p.items-list-label {
            font-size: 0.75rem;
            color: #991b1b; // red-800
            margin: 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;

            .info-icon-small {
              font-size: 0.875rem; // 14px
              width: 0.875rem;
              height: 0.875rem;
            }
          }
        }

        .items-scroll-container {
          max-height: 8rem; // 32 * 0.25rem
          overflow-y: auto;
          padding-right: 0.25rem;
          @include common.shared-scrollbar-style();
        }

        .items-list {
          font-size: 0.75rem;
          color: #374151; // gray-700
          font-family: 'Roboto Mono', monospace;
          margin: 0;
          padding: 0;
          list-style: none;

          .item-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
          }

          .item-dot {
            width: 0.25rem;
            height: 0.25rem;
            border-radius: 9999px;
            background-color: #f87171; // red-400
            flex-shrink: 0;
          }
        }

        .note-text {
          font-size: 0.75rem;
          line-height: 1rem;
          text-align: center;
          margin-top: 0;
        }
      }
    }
  }
}

.sub-modal-actions {
  padding: 0rem;
  gap: 0.75rem;
  min-height: fit-content;
}

.sub-modal-icon {
  font-size: 2.5rem;
  width: 2.5rem;
  height: 2.5rem;
}

.success-icon {
  color: #16a34a;
}

.info-icon {
  color: #1976d2;
}

.warning-icon {
  color: #f59e0b;
}

.error-icon {
  color: #c5221f;
}

.primary-button {
  @include common.shared-button('primary');

  &.destructive {
    @include common.shared-button('destructive');
  }
}

.secondary-button {
  @include common.shared-button('secondary');
}



@media (max-width: 640px) {
  .sub-modal-content {
    padding: 1.5rem 1rem;
    max-width: 100%;

    h3 {
      font-size: 1rem;
      line-height: 1.5rem;
      margin-bottom: 0.75rem;
    }

    p {
      margin-bottom: 1rem;
      max-width: 100%;
    }

    .html-content {
      margin-bottom: 1rem;
      width: 100%;
    }
  }
}
